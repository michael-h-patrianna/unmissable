<!-- Generated by SpecStory -->

# Refining PRD with features and acceptance criteria (2025-08-15 18:37Z)

_**User**_

check the prd.md

add missing features.
make requirements and acceptance criteria clear.
clarify acceptance criteria for test cases.
format 

---

_**Assistant**_

I'll create the three workflow files to plan and track the work, then update your `prd.md` with added features, clearer and testable acceptance criteria, and improved formatting. I'm going to update your PRD to add missing features, make all requirements and acceptance criteria testable with clear GIVEN/WHEN/THEN scenarios, and improve the formatting; I'll also update the internal tracking files and fix their markdown formatting. 
```

```
Batch editing to fix markdown formatting errors and finalize the refined PRD: I’ll update `prd.md` to use proper headings and spacing for lists, and clean up the `` tracker files with correct blank lines and final statuses. 
```

```

```

```

```

```

```

```
Checkpoint: Created planning files and drafted a fully structured, testable PRD. Next, I’ll replace `prd.md` with the refined version (proper headings, BDD AC, removed duplicates) and ensure markdown linting passes. I reviewed and rewrote your PRD to add missing features, make requirements and acceptance criteria testable, and clean up formatting; I also set up lightweight tracking docs to manage scope and validation.

## What I changed

- Expanded features: onboarding, permissions, Focus/DND behavior, link parsing across providers, offline cache, multi-display hot-plug, global shortcuts, error handling, local logs.
- Clear, testable AC: Converted to BDD-style (GIVEN/WHEN/THEN), with measurable outcomes and negative/edge cases.
- Added explicit “Test Cases” per story to guide QA.
- Formatting: Proper headings, consistent sections (Epics → Stories → Requirements → Acceptance Criteria → Test Cases), spacing for lint-friendly Markdown.

## Files changed

- `prd.md` — Rewritten with clear structure, added features, BDD AC, and test cases (now the single source of truth).
- `beast-tasks.md` — Phase plan and task tracker; statuses set to done.
- `beast-knowledge.md` — Assumptions, decisions, context, sources.
- `beast-prd.md` — One-page PRD shell: problem, users, goals, scope, functional/non-functional, AC pattern.

## Where to look

- Primary spec: `prd.md`
  - E1: OAuth + calendar selection; polling + parsing (Meet/Zoom/Teams/Webex/generic), timezone handling, all-day exclusions.
  - E2: Full-screen overlay (multi-display, countdown, Focus override), impossible-to-miss behavior (blocking, sound options, wake/lock handling).
  - E3: One-click join with provider selection and defaults; malformed URL handling.
  - E4: Preferences (timing rules, theme/opacity/font, minimal mode), Snooze (1/5/10 min).
  - E5: Reliability (24h cache, offline behavior, backoff, hot-plug displays).
  - E6: Auto-join at start; global shortcuts; Focus mode integration.
  - Cross-cutting: First-run onboarding, permissions, error messaging, local logs, metrics.

## Acceptance criteria clarity for test cases

- Each story now includes:
  - Requirements: actionable, unambiguous.
  - Acceptance Criteria: BDD format with measurable thresholds (e.g., “overlay appears within 500 ms,” “join opens within 1 s”).
  - Test Cases: concrete verification points (e.g., token refresh, URL handler protocols, timezone switch, snooze persistence, DND override behavior).

## Quality gates

- Lint-friendly Markdown: top-level H1 present; blank lines around lists; consistent heading levels and spacing.
- Scope traceability: IDs added (E#-S#) for stories to map to implementation and tests.

## Requirements coverage

- Add missing features: Done (onboarding, permissions, error handling, logs, provider selection, Focus/DND, shortcuts).
- Make requirements and AC clear: Done (GIVEN/WHEN/THEN with metrics).
- Clarify AC for test cases: Done (explicit “Test Cases” per story).
- Format: Done (consistent structure, lint-friendly spacing).

Done

---

_**User**_

review the prd.md
the goal is to give this prd to an llm coding agent and let him implement the whole app. revise the document to be llm-friendy. 
add the techstack we use.
the implementation should be test-automation heavy.

---

_**Assistant**_

I’ll update the PRD to be LLM-friendly by adding a concrete tech stack, repo structure, coding standards, and a test-automation-first implementation guide; I’ll also refresh the tracking files to reflect this new phase. I’m going to insert LLM-specific implementation guidance into `prd.md` (tech stack, repo structure, coding/testing/CI standards, data models, and milestones) and update the knowledge/tasks trackers to reflect the new decisions. 
```

```


---

_**User**_

@agent Try Again

---

_**Assistant**_

I’ll fix markdown lint issues and make the PRD fully LLM-friendly by adding heading levels, proper spacing, code block language, and link formatting, plus standardize section headings for requirements, acceptance criteria, and test cases. 
```

```
To resolve the markdown lint errors and make the document fully LLM-friendly, I’ll update all repeated subheadings to include story IDs (e.g., “Requirements — E1-S1”), and ensure consistent spacing around lists and code blocks. 
```

```
I’ll make the PRD fully LLM-friendly with an executable tech stack, structure, and test-first guidance, then fix markdown lint issues so it’s clean for automation.

## Checklist
- Add explicit tech stack and repository layout (for LLM agent). [Done]
- Make implementation test-automation heavy with clear testing/CI standards. [Done]
- Ensure headings, lists, code blocks, and links are lint-friendly. [Done]
- Keep epics/stories/AC intact and traceable; add story-scoped section IDs. [Done]

## Actions taken
- Inserted “LLM Implementation Guidance” with guardrails for small modules, standard Swift APIs, and test-first development.
- Added authoritative tech stack and SPM dependencies, plus repository layout and named modules/files.
- Specified Permissions/Entitlements, Build & Run, Coding Standards, and a CI pipeline with gates.
- Added Data Models & Contracts section for Event and service interfaces (CalendarService, LinkParser, Scheduler).
- Wrote a milestone sequence for the coding agent.
- Standardized story subheadings to avoid duplicate-heading lint (e.g., “Requirements — E1-S1”).
- Fixed markdown issues:
  - Top-level H1 and proper section headings.
  - Blank lines around lists.
  - Fenced code block language tag set to “text”.
  - Converted bare URLs to markdown links.

## What you have now
- `prd.md` starts with LLM guardrails, tech stack, repo layout, dependencies, permissions, build/run, coding standards, test automation strategy, data models, CI pipeline, and milestones.
- All Epics and Stories preserve your intent, with BDD-style Acceptance Criteria and explicit Test Cases.
- Headings are unique and traceable per story (E#-S#), which is convenient for the agent to map to modules and tests.

## Test automation emphasis
- ≥80% coverage for Core/Features required; deterministic time via an 

---

_**User**_

goal is to write the project fully in vscode. we have xcode and build tools installed. is this sufficient?

---

_**Assistant**_

I’ll update the PRD to explicitly support VS Code development (extensions, build/run/debug/test from VS Code, caveats) and refresh the internal tracking/knowledge docs to capture these decisions. 
```

```
I’m fixing remaining markdown lint issues in `prd.md` so the VS Code guidance is clean and ready, then I’ll answer your question with a concise checklist and verification steps. 
```

```
Here’s a quick, actionable answer and I’ve already updated `prd.md` to be VS Code–first.

Checklist for developing fully in VS Code
- You have Xcode + CLT installed and signed in once in Xcode (for codesign): Yes, required.
- VS Code extensions:
  - Swift (swift-server-work-group.swift)
  - CodeLLDB (vadimcn.vscode-lldb)
  - Optional wrappers for SwiftFormat/SwiftLint
- Build/test using Xcode toolchain from VS Code:
  - xcodebuild for app build/tests
  - swift test for package-only targets
- Debugging:
  - Use CodeLLDB to launch/attach the built app
  - Note: SwiftUI Previews require Xcode; use SnapshotTesting + XCUITest instead
- Signing:
  - Open Xcode once, sign in to your Apple ID, accept licenses, and let automatic signing configure the team
- CI:
  - GitHub Actions with macOS 14 runner is fine; run xcodebuild and collect xcresult/coverage

Sufficiency verdict
- Yes, Xcode + build tools are sufficient to develop entirely in VS Code.
- You don’t need to work inside Xcode day-to-day after initial sign-in and team setup.
- Caveat: SwiftUI Live Previews are Xcode-only; the PRD directs you to snapshot and UI tests as alternatives.

What I added to the PRD
- LLM Implementation Guidance section (tech stack, repo layout, coding standards)
- VS Code Development section with required extensions, toolchain checks, build/test/debug commands, and signing notes
- Test-automation-first strategy with coverage gates and deterministic time/network
- Minor formatting fixes for markdown linting

Try this sanity check in VS Code terminal (zsh)
- Verify toolchain:
  - xcodebuild -version
  - swift --version
  - xcode-select -p
- Build:
  - xcodebuild -scheme Unmissable -destination 'platform=macOS' build
- Tests:
  - xcodebuild -scheme Unmissable -destination 'platform=macOS' test

If you want, I can scaffold the repo skeleton from the PRD next.

---

_**User**_

xcodebuild -version

Xcode 16.4
Build version 16F6

michaelhaufschild@Michaels-MacBook-Pro unmissable % swift --version
swift-driver version: 1.120.5 Apple Swift version 6.1.2 (swiftlang-6.1.2.1.2 clang-1700.0.13.5)
Target: arm64-apple-macosx15.0

michaelhaufschild@Michaels-MacBook-Pro unmissable % xcodebuild -scheme Unmissable -destination 'platform=macOS' test
Command line invocation:
    /Applications/Xcode.app/Contents/Developer/usr/bin/xcodebuild -scheme Unmissable -destination platform=macOS test

2025-08-15 20:50:03.182 xcodebuild[81068:2058092] Writing error result bundle to /var/folders/r7/vs3cq2f93k9g_wd7kqgv422m0000gn/T/ResultBundle_2025-15-08_20-50-0003.xcresult
xcodebuild: error: The directory /Users/michaelhaufschild/Documents/code/unmissable does not contain an Xcode project, workspace or package.


---

_**Assistant**_

I’ll scaffold a minimal Swift Package so you can build and test in VS Code immediately, and explain why xcodebuild failed plus how to proceed (swift test now; Xcode project later). 

---

